let img = 'data:image/png;base64,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';

let partList = `
id  |x|y |w |h|mh|name
t0  |0|0 |7 | |  |tail side view
j0  |1|0 |20| |  |articulated junction (280)
a   |2|  |  | |17|axels
a0  | |0 |16| |  |pneumatic rear
a1  | |1 |17| |  |springs rear (255, 266)
a2  | |2 |15| |  |ifa rear (211)
a3  | |3 |16| |  |pneumatic front
a4  | |4 |17| |  |springs front (255, 266)
a5  | |5 |15| |  |ifa front (211)
w   |3|  |  | |21|windows
w0  | |0 |25| |  |sliderless
w1  | |1 |25| |  |small sliders
w2  | |2 |25| |  |large sliders
w3  | |3 |16| |  |narrow
w3  | |4 |14| |  |narrow sliderless
w5  | |5 |16| |  |short, narrow
w6  | |6 |7 | |  |tiny
w7  | |7 |30| |  |wide sliderless (255.72)
w8  | |8 |30| |  |wide
l   |4|  |  | |17|hatches
l0  | |0 |20| |  |tall
l1  | |1 |20| |  |batt. (260.50)
l2  | |2 |20| |  |short
l3  | |3 |20| |  |fuel tank (260.50)
l4  | |4 |13| |  |exhaust grill
l5  | |5 |13| |  |radiator grill
l00 | |9 |39| |  |double
l000| |10|58| |  |tripple
l6  | |11|39| |  |engine
d   |5|  |  | |  |doors
d0  | |0 |16| |  |hinged tall (255.72)
d1  | |1 |16| |  |hinged short  (256.54)
d2  | |2 |16| |  |sliding rear (250.59)
d3  | |3 |16| |  |sliding front (250.59)
d4  | |4 |22| |  |folding front (260.50)
d5  | |5 |22| |  |gliding (280.64)
d6  | |6 |24| |  |gliding wide (263.00)
d7  | |7 |22| |  |folding (260.50)
d8  | |8 |16| |  |steyr (old 256)
h   |6|  |7 | |  |head side view
h0  | |0 |  | |  |steel bumper
h1  | |1 |  | |  |plastic bumper (250.59)
`;


function genRules() {
    return partList.split('\n')
        .filter(v => v && '' !== v.trim())
        .slice(1)
        .map(l => l.split('|').map(v => v.trim()))
        .map(a => {
            const [id, x, y, w, h, mh, name] = a;
            console.log([id, x, y, w, h, mh, name]);
            const partType = id[0];
            const baseline = 'al'.indexOf(partType) >= 0 ? 'bottom' : 'top';
            const selector = `.shadow:has(~ .picker :checked + .${id}) .${baseline},.${id}`;
            const xexpr = `calc(var(--dx)${1 == x ? '' : ` * ${x}`} - 1px)`;
            const yexpr = `calc(var(--dy)${1 == y ? '' : ` * ${y}`}${'bottom' === baseline ? ' - 29px' : ''})`;
            const rules = [
                x && y ? `background-position: ${xexpr} ${yexpr}`
                    : x > 0 ? `background-position-x: ${xexpr}`
                        : y > 0 ? `background-position-y: ${yexpr}` : '',
                w ? `width: ${w}px` : '',
                mh ? `min-width: ${mh}px` : ''
            ].filter(r => r && r.trim() !== "");
            
            return rules.length ? selector + ': ' + rules.join('; ') : '';
        }).filter(v => v && '' !== v.trim()).join(';\n');
}

let _var = {
    ax: -29,
    get wx() { return this.ax - 18; },
    get lx() { return this.wx - 31; },
    get dx() { return this.lx - 31; },
    get hx() { return this.dx - 25; },
    dy: -47,
    bg: 'silver'
};

var livrey = {
    c: 'line-height: 52px; padding-left: 200px; margin-right:-200px; background-size: calc(100% - 20px) 42px; background-position: 5px 8px; background-repeat: no-repeat;',
    c1: `background-image: linear-gradient(to bottom, #E19000 52px, ${_var.bg} 52px);`,
    c2: `background-image: linear-gradient(to bottom, white 10px 20px, #3B77B3 20px 32px, white 32px);`
};

let cssSrc = {
    t0: 'background-position: 0 0; padding-left: 7px;',
    l: `background-position-x: ${_var.lx}px; margin-left: -22px; padding-left: 22px;`,
    l1: `background-position-y: calc(${_var.dy}px * 1);`,
    l3: `background-position-y: calc(${_var.dy}px * 3);`,
    d: `background-position-x: ${_var.dx}px; padding-right: 22px;`,
    d4: `background-position-y: calc(${_var.dy}px * 4);`,
    d7: `background-position-y: calc(${_var.dy}px * 7);`,
    a: `background-position-x: ${_var.ax}px; margin-left: -19px; padding-left: 19px;`,
    a0: 'padding-left: 8px; padding-right: 8px;',
    a3: `background-position-y: calc(${_var.dy}px * 3); padding-left: 17px;`,
    w: `background-position-x: ${_var.wx}px;padding-left: 25px;`,
    w2: `background-position-y: calc(${_var.dy}px * 2);`,
    h: 'background-position-y: 0; padding-left: 7px;',
    h0: `background-position-x: ${_var.hx}px;`
}

let css = {
    _: `background-image: url(${img}); font-size: 0; line-height: 47px;`,
    t0: 'background-position: 0 0; padding-left: 7px;',
    l: `background-position-x: ${_var.lx}px; margin-left: -22px; padding-left: 22px;`,
    l1: `background-position-y: calc(${_var.dy}px * 1);`,
    l3: `background-position-y: calc(${_var.dy}px * 3);`,
    d: `background-position-x: ${_var.dx}px; padding-right: 22px;`,
    d4: `background-position-y: calc(${_var.dy}px * 4);`,
    d7: `background-position-y: calc(${_var.dy}px * 7);`,
    a: `background-position-x: ${_var.ax}px; margin-left: -19px; padding-left: 19px;`,
    a0: 'padding-left: 8px; padding-right: 8px;',
    a3: `background-position-y: calc(${_var.dy}px * 3); padding-left: 17px;`,
    w: `background-position-x: ${_var.wx}px;padding-left: 25px;`,
    w2: `background-position-y: calc(${_var.dy}px * 2);`,
    h: 'background-position-y: 0; padding-left: 7px;',
    h0: `background-position-x: ${_var.hx}px;`
};

var groupped_rx = /([cdhfrtw])(\d+)\s*(?:([al])(\d+))?/g;
var linear_rx = /(\w)(\d+)/g;

function logBus(bus = 't0 d7 w2 a0 w2 l1 d7 w2 l3 w2 a3 d4 h0 f0 h0 w3 l2 w2 a3 w2 l2 w2 w2 w2 a0 w2 l2 t0 r0 c1') {
    let c = bus.match(/c\d+/).shift();

    var bricks = bus.split(/(?<=h\d+)/g)[0].matchAll(linear_rx).toArray().map(m =>
        css._ + css[m[1]] + css[m[1] + m[2]]
    );

    console.log(Array(bricks.length + 2).join('%c '), livrey.c + livrey[c], ...bricks);
}